{% extends "app_home/pages/home.html" %}

{% block content %}
<h2>Registro de EPI</h2>
<form method="POST">
    {% csrf_token %}
    {{ form.non_field_errors }}
    
    {{ form.equipamento.label }}: {{ form.equipamento }}<br>
    {{ form.colaborador.label }}: {{ form.colaborador }}<br>
    {{ form.status.label }}: {{ form.status }}<br>
    {{ form.condicao_equipamento.label }}: {{ form.condicao_equipamento }}<br>

    <div id="div-observacao" style="display:none;">
        {{ form.observacao.label }}: {{ form.observacao }}<br>
    </div>

    <div id="div-devolucao" style="display:none;">
        {{ form.data_devolucao.label }}: {{ form.data_devolucao }}<br>
    </div>

    {{ form.data_emprestimo.label }}: {{ form.data_emprestimo }}<br>
    {{ form.data_prevista_da_devolucao.label }}: {{ form.data_prevista_da_devolucao }}<br>

    <button type="submit">Cadastrar</button>
</form>

{% if messages %}
    {% for message in messages %}
        <p style="color:red;">{{ message }}</p>
    {% endfor %}
{% endif %}

<script>
    const statusField = document.getElementById("id_status");
    const observacaoDiv = document.getElementById("div-observacao");
    const devolucaoDiv = document.getElementById("div-devolucao");

    function toggleCamposExtras() {
        const valor = statusField.value;
        if (valor === "devolvido" || valor === "danificado" || valor === "perdido") {
            observacaoDiv.style.display = "block";
            devolucaoDiv.style.display = "block";
        } else {
            observacaoDiv.style.display = "none";
            devolucaoDiv.style.display = "none";
        }
    }

    statusField.addEventListener("change", toggleCamposExtras);
    document.addEventListener("DOMContentLoaded", toggleCamposExtras);
</script>
{% endblock %}