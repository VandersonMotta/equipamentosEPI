python manage.py shell
{% extends "app_home/pages/home.html" %}

{% block content %}
<h2>Registro de EPI</h2>
<form method="POST">
    {% csrf_token %}
    {{ form.non_field_errors }}
    
    <div>
        {{ form.equipamento.label }}: 
        {{ form.equipamento }}
        {% for error in form.equipamento.errors %}
            <p style="color:red;">{{ error }}</p>
        {% endfor %}
    </div>
    
    <div>
        {{ form.colaborador.label }}: 
        {{ form.colaborador }}
        {% for error in form.colaborador.errors %}
            <p style="color:red;">{{ error }}</p>
        {% endfor %}
    </div>

    <div>
        {{ form.status.label }}: 
        {{ form.status }}
        {% for error in form.status.errors %}
            <p style="color:red;">{{ error }}</p>
        {% endfor %}
    </div>

    <div>
        {{ form.condicao_equipamento.label }}: 
        {{ form.condicao_equipamento }}
        {% for error in form.condicao_equipamento.errors %}
            <p style="color:red;">{{ error }}</p>
        {% endfor %}
    </div>

    <!-- Campos dinâmicos (observação e devolução) -->
    <div id="div-observacao" style="display:none;">
        {{ form.observacao.label }}: 
        {{ form.observacao }}
        {% for error in form.observacao.errors %}
            <p style="color:red;">{{ error }}</p>
        {% endfor %}
    </div>

    <div id="div-devolucao" style="display:none;">
        {{ form.data_devolucao.label }}: 
        {{ form.data_devolucao }}
        {% for error in form.data_devolucao.errors %}
            <p style="color:red;">{{ error }}</p>
        {% endfor %}
    </div>

    <div>
        {{ form.data_emprestimo.label }}: 
        {{ form.data_emprestimo }}
        {% for error in form.data_emprestimo.errors %}
            <p style="color:red;">{{ error }}</p>
        {% endfor %}
    </div>

    <div>
        {{ form.data_prevista_da_devolucao.label }}: 
        {{ form.data_prevista_da_devolucao }}
        {% for error in form.data_prevista_da_devolucao.errors %}
            <p style="color:red;">{{ error }}</p>
        {% endfor %}
    </div>

    <button type="submit">Cadastrar</button>
</form>

<!-- Exibição de mensagens de sucesso/erro -->
{% if messages %}
    {% for message in messages %}
        <p style="color:red;">{{ message }}</p>
    {% endfor %}
{% endif %}

<script>
    const statusField = document.getElementById("id_status");
    const observacaoDiv = document.getElementById("div-observacao");
    const devolucaoDiv = document.getElementById("div-devolucao");

    function toggleCamposExtras() {
        const valor = statusField.value;
        if (valor === "devolvido" || valor === "danificado" || valor === "perdido") {
            observacaoDiv.style.display = "block";
            devolucaoDiv.style.display = "block";
        } else {
            observacaoDiv.style.display = "none";
            devolucaoDiv.style.display = "none";
        }
    }

    statusField.addEventListener("change", toggleCamposExtras);
    document.addEventListener("DOMContentLoaded", toggleCamposExtras);
</script>

{% endblock %}
